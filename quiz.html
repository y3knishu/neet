<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Minimal Quiz Test</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #question { font-weight: bold; margin-bottom: 10px; }
    .option-btn { display: block; margin: 6px 0; padding: 8px 12px; cursor: pointer; border: 1px solid #333; border-radius: 4px; }
    .correct { background-color: #27ae60; color: white; }
    .wrong { background-color: #e74c3c; color: white; }
  </style>
</head>
<body>

<h2>Minimal Quiz Test</h2>
<div id="loading">Loading questions...</div>

<div id="quiz" style="display:none;">
  <div id="question"></div>
  <div id="options"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDr3_9dpo55esyfpkwsAjfFi_1KMu0ZDrU",
    authDomain: "neet-88499.firebaseapp.com",
    projectId: "neet-88499",
    storageBucket: "neet-88499.firebasestorage.app",
    messagingSenderId: "889163298965",
    appId: "1:889163298965:web:fbae28b0ba478cff2f839c",
    measurementId: "G-GEG090K2JQ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Change this subject exactly as stored in Firestore (case sensitive)
  const subject = "Anatomy";

  async function loadQuestions() {
    const q = query(collection(db, 'questions'), where('subject', '==', subject));
    const querySnapshot = await getDocs(q);

    console.log(`Questions for subject "${subject}":`, querySnapshot.size);
    if (querySnapshot.size === 0) {
      alert(`No questions found for subject "${subject}"`);
      document.getElementById('loading').textContent = 'No questions found.';
      return;
    }

    const questions = [];
    querySnapshot.forEach(docSnap => {
      const data = docSnap.data();
      questions.push(data);
      console.log('Question data:', data);
    });

    document.getElementById('loading').style.display = 'none';
    startQuiz(questions);
  }

  function startQuiz(questions) {
    const quizDiv = document.getElementById('quiz');
    const questionDiv = document.getElementById('question');
    const optionsDiv = document.getElementById('options');

    let currentQuestionIndex = 0;

    function showQuestion(index) {
      const q = questions[index];
      questionDiv.textContent = q.question;

      optionsDiv.innerHTML = '';
      q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.className = 'option-btn';

        btn.onclick = () => {
          // Disable all buttons after click
          Array.from(optionsDiv.children).forEach(b => b.disabled = true);

          if (idx === Number(q.correctAnswer)) {
            btn.classList.add('correct');
            alert('Correct!');
          } else {
            btn.classList.add('wrong');
            alert(`Wrong! Correct answer is option ${q.correctAnswer}`);
          }
        };

        optionsDiv.appendChild(btn);
      });
    }

    quizDiv.style.display = 'block';
    showQuestion(currentQuestionIndex);
  }

  loadQuestions();
</script>

</body>
</html>
